pico-8 cartridge // http://www.pico-8.com
version 35
__lua__
playertip_sprite=1
player_sprite=2 
player_x=64
player_y=100

objs={}
obj_start=16
obj_count=3
obj_interval=16

gravity=2

level=1
health=5

-- code here happens during
-- the initial game load
function _init()
 t,f,s=0,1,4 -- tick,frame,step
 sp={3,4,19,20} --sprites

	for i=1,level do
		obj={
			sprite=flr(rnd(obj_count)+obj_start),
			x=flr(rnd(120)+5),
			y=i*(-obj_interval)
		}
		add(objs,obj)
	end
end

--code here runs 30 times
--per second
function _update()
 --left
	if btn(0) then player_x-=2 end
	--right
	if btn(1) then player_x+=2 end

 t=(t+1)%s -- change tick
 if (t==0) f=f%#sp+1 -- change frame

	for obj in all(objs) do
			obj.y+=gravity
			
			if obj.y+4>player_y-8
			and obj.y+4<player_y
			and obj.x+4>player_x
			and obj.x+4<player_x+8 then
			health-=1
			del(objs,obj)
			end
			
			if obj.y>100 then
			 del(objs,obj)
			end
	end
	
	if #objs==0 then
			level +=1
			_init()
	end
end

-- code here runs 30 times
-- per second, but only
-- after the update() func
function _draw()
	cls()
	spr(player_sprite,player_x,player_y)
	spr(playertip_sprite,player_x,player_y-8)	
	spr(sp[f], player_x, player_y)
	
	for obj in all(objs) do
		spr(obj.sprite,obj.x,obj.y)
	end

	print("health="..health)
end

__gfx__
00000000000000000066666000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000065556000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000651115600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000656665600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000060000666666600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000060000655555600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000066600006666600c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000006660000880880c00000000000000c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00006a00000440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00060000000440007770077700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00060000004444007070070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00555500004004007070070700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555550040000407777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
05555550049999407777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0555555004999940777777777c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
005555000444444077777777c0000000000000070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
